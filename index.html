<html><head><title>JS13KGames - Jerome Lecomte</title><script src=https://js13kgames.com/webxr-src/aframe.js></script><script>AFRAME.registerComponent("screen-manager",{schema:{},init(){this.el.addState("title-screen"),this.titleEl=this.el.querySelector("#title"),this.startButtonEl=this.el.querySelector("#start-button"),this.endEl=this.el.querySelector("#end"),this.timerEl=this.el.querySelector("#timer"),this.shotsEl=this.el.querySelector("#shots"),this.chickenEls=Array.from(this.el.querySelectorAll(".chicken")),this.outlawEls=Array.from(this.el.querySelectorAll(".outlaw")),this.onGameStart=AFRAME.utils.bind(this.onGameStart,this),this.onStateRemoved=AFRAME.utils.bind(this.onStateRemoved,this),this.onShotFired=AFRAME.utils.bind(this.onShotFired,this),this.startButtonEl.addEventListener("mouseenter",this.onGameStart),this.outlawEls.forEach(function(t){t.addEventListener("stateremoved",this.onShotFired)})},onGameStart(){this.startButtonEl.removeEventListener("mouseenter",this.onGameStart),this.el.addState("game-screen"),this.el.removeState("title-screen"),this.elapsedTime=0,this.shotsFired=0,[this.titleEl,...this.chickenEls].forEach(t=>{t.setAttribute("visible",!1)}),[this.timerEl,this.shotsEl,...this.outlawEls].forEach(t=>{t.setAttribute("visible",!0)}),this.outlawEls.forEach(t=>{t.object3D.position.y+=100.6})},tick(t,e){if(this.el.is("game-screen")){this.elapsedTime+=e/1e3;const t=Math.floor(this.elapsedTime/60),i=Math.floor(this.elapsedTime-t);this.timerEl.setAttribute("value",`time\n${t}:${10>i?"0":""}${i}`),this.outlawEls.find(t=>t.is("up"))||(this.el.removeState("game-screen"),this.el.addState("end-screen"),this.endEl.setAttribute("visible",!0))}},onShotFired(){this.shotsFired+=1,this.shotsEl.setAttribute("value",`shots\n${this.shotsFired}`)}}),AFRAME.registerComponent("target",{schema:{revive:{default:"#null.null",type:"selectorAll"}},init(){this.isOutlaw=this.el.getDOMAttribute("class").includes("outlaw"),this.el.addState("up"),this.targetEl=document.createElement("a-ring"),this.targetEl.setAttribute("color","red"),this.targetEl.setAttribute("radius-inner",.1),this.targetEl.setAttribute("radius-outer",.6),this.targetEl.object3D.position.set(0,.6,0),this.el.appendChild(this.targetEl),this.onShot=AFRAME.utils.bind(this.onShot,this),this.onDeadOrAlive=AFRAME.utils.bind(this.onDeadOrAlive,this),this.onRevive=AFRAME.utils.bind(this.onRevive,this),this.el.addEventListener("mouseenter",this.onShot)},onShot(){if(this.el.is("up")){this.el.removeState("up");const t={from:0,dur:800};if(this.el.components.animation){const e=this.el.components.animation.animation;t.dur-=e.currentTime,t.from=e.animations[0].currentValue}this.el.setAttribute("animation",{...t,property:"object3D.rotation.x",to:-90,easing:"easeOutElastic",elasticity:800}),this.el.addEventListener("animationcomplete",this.onDeadOrAlive),this.data.revive.forEach(t=>{t.components.target.onRevive()}),this.isOutlaw&&this.el.sceneEl.components["screen-manager"].onShotFired()}},onDeadOrAlive(){this.el.removeAttribute("animation"),this.el.removeEventListener("animationcomplete",this.onDeadOrAlive)},onRevive(){if(!this.el.is("up")){this.el.addState("up");const t={from:-90,dur:800};if(this.el.components.animation){const e=this.el.components.animation.animation;t.dur-=e.currentTime,t.from=e.animations[0].currentValue}this.el.setAttribute("animation",{...t,property:"object3D.rotation.x",to:0,easing:"easeOutElastic",elasticity:800}),this.el.addEventListener("animationcomplete",this.onDeadOrAlive)}}});</script></head><body><a-scene screen-manager><a-entity id=title position="0 2 -6"><a-text align=center animation="property: rotation; from: -2 -5 -1; to: 2 5 1; dur: 2000; loop: true; dir: alternate; easing: easeInOutQuad" color=black font=mozillavr position="0 0 0" scale="3 3 1" value="Don't look back!"></a-text><a-text color=black align=center font=roboto position="0 -1 0" scale="0.75 0.75 1" value="a JS13KGAMES 2019 game\nby Jerome Lecomte"></a-text></a-entity><a-text id=start-button align=center color=black font=mozillavr position="0 1.5 5" rotation="0 180 0" value="Oh boy, you looked back!\nNow the outlaws are after you.\nI sure hope you're a fast gun, cowboy!"></a-text><a-camera look-controls position="0 2 0"><a-text id=end align=center color=black font=mozillavr position="0 0 -1" scale="0.25 0.25 1" value="You survived, cowboy!\n\nYou really are the fastest gun\nin the whole wild West!" visible=false></a-text><a-text id=timer align=left color=black font=mozillavr position="-0.3 -0.3 -1" scale="0.25 0.25 1" value=time\n0:00 visible=false></a-text><a-text id=shots align=right color=black font=mozillavr position="0.3 -0.3 -1" scale="0.25 0.25 1" value=shots\n0 visible=false></a-text><a-cursor></a-cursor></a-camera><a-entity class="chicken one" position="-2.5 0.5 -4.5" target="revive: .chicken.two" visible=true></a-entity><a-entity class="chicken two" position="0 0.5 -4.5" target visible=true></a-entity><a-entity class="chicken three" target="revive: .chicken.one, .chicken.two" position="2.5 0.5 -4.5" visible=true></a-entity><a-entity class="outlaw one" position="-2.5 -100.5 -6.5" target="revive: .outlaw.two" visible=false></a-entity><a-entity class="outlaw two" position="2.5 -100.5 -6.5" target visible=false></a-entity><a-plane position="0 0 0" rotation="-90 0 0" width=150 height=150 color=#DBB742></a-plane><a-icosahedron color=#FF926B position="-2 0.25 -4" rotation="0 45 0" radius=1></a-icosahedron><a-sky color=#36C3FF></a-sky></a-scene></body></html>